# === App Basics ===
APP_ENV=dev
APP_HOST=0.0.0.0
APP_PORT=8000
APP_DEBUG=true
APP_ISS=http://localhost:8000
APP_AUD=web
ACCESS_TTL_SECONDS=900
REFRESH_TTL_SECONDS=1209600
CLOCK_SKEW_SECONDS=60

# === Database ===
DATABASE_URL=postgresql+psycopg2://auth_user:auth_pass@localhost:5432/auth_db

# === CORS ===
CORS_ALLOW_ORIGINS=*
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=GET,POST,OPTIONS
CORS_ALLOW_HEADERS=*,Authorization,Content-Type

# === Rate Limit (simple in-memory) ===
RATE_LIMIT_LOGIN=5/60      # 5 requests per 60 seconds per IP
RATE_LIMIT_REFRESH=10/60   # 10 requests per 60 seconds per IP

# === Crypto Keys (JWKS) ===
# For dev, keys are loaded from ./env/keys/*.json if present; otherwise generated at startup.
KEYS_DIR=env/keys
JWKS_KEY_SIG_ACTIVE_KID=sig-dev-1
JWKS_KEY_ENC_ACTIVE_KID=enc-dev-1
JWKS_KEY_FRONT_ACTIVE_KID=enc-front-dev-1
KEY_ROTATION_GRACE_SECONDS=86400

# === Cookies ===
REFRESH_COOKIE_NAME=__Host-refresh
REFRESH_COOKIE_SECURE=false
REFRESH_COOKIE_SAMESITE=Lax
REFRESH_COOKIE_PATH=/auth